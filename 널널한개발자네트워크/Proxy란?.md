nginx와 리버스프록시개념.등등

https://www.youtube.com/watch?v=dThqHi8-MiQ&list=PLXvgR_grOs1BFH-TuqFsfHqbh-gpMbFoy&index=20&ab_channel=%EB%84%90%EB%84%90%ED%95%9C%EA%B0%9C%EB%B0%9C%EC%9E%90TV

클라이언트가 자신을 통해서 다른 네트워크 서비스에 간접적으로 접속할 수 있게 해 주는 시스템

![프록시_동작_과정](https://user-images.githubusercontent.com/75001605/163829821-073faa0f-9ae4-421e-ae97-4f0524a40f26.png)


https://jcdgods.tistory.com/322

포워드 프록시 서버의 메시지를 클라이언트에 전달하는 역할 수행
Back-end to Front-end

리버스 프록시  클라이언트의 요청을 다수 서버에 분배하여 전달하는 역할 수행
Front-end to Back-end

클라이언트의 요청은 프록시를 통해 목적 서버로 전달되고,
서버의 응답 또한 프록시를 통해 요청 클라이언트에게 전달된다.

캐싱,  데이터를 릴레이 하는 과정에서 자주 사용되는 데이터는 저장한다.
재요청이 있을 때 원본 서버까지 가지 않고 캐시된 데이터를 전송한다.


트레픽 통제 네트워크 접근이 특정 프록시 서버를 통해서만 이루어지도록 한다.
프록시 서버에서 네트워크 패킷을 검열하거나 필터링 할 수 있다.

익명성


 (1) 포워드 프록시의 캐싱 기능과 서버 로드 경감 
 프록시의 본래의 역할은 자주 사용되는 데이터를 확보해두고, 이를 캐싱(재활용)하는 것이다. 따라서 자연스럽게 서버의 로드가 감소하게 된다. 

 (2) 하나의 IP, 다수의 웹 서비스 사용자가 특정 도메인으로 요청을 전송하면, 대부분의 DNS는 도메인별 등록된 IP의 Well-known 포트 80(HTTP), 443(HTTPS)으로 이 요청을 릴레이한다.  
 따라서 1 Domain - 1 IP - 1 Server가 되어야 하나, IP의 한정된 수량(IPv4를 말함)과 가격적인 측면 그리고 관리 용이성등 다양한 이유로 1개의 IP로 다수의 웹 서버를 동작시킬 수 있다.

 (3) 실제 서버 직접 접근 차단 
 (2)과 같이 외부에 노출되는 IP는 프록시 서버의 공인 IP이며, 실제 동작하는 서버는 사설 IP를 할당받아 동작한다. 따라서 망 분리를 통해 클라이언트가 직접적으로 서버의 IP를 알 수 없기 때문에 보안이 다소 취약한 HTTP 프레임워크를 숨겨 이를 보호 할 수 있다. 다만 이것만 믿고 보안이 완벽하다고 생각하지 말자. 


어떤 PC가 한대있다.  PC-> 인터넷 연결.네이버 같은곳에 접속하고싶을때. 자기 주소가 3.3.3.3이고, 네이버가 5.5.5.5라고 가정하면

3.3.3.3 이라는 호스트가 5.5.5.5 호스트에게 TCP/IP연결. 


인터넷에 PC2번 연결돼서 나의 IP 9.9.9.9 PC 1번이 PC2번을 PROXY로 설정해버리면~?

소켓이 프록시한테가고 그다음에 네이버에감. 대리자라는 뜻

소켓을 하나 또열어서. 5.5.5.5한테 접속한다

왜 돌아가냐?  USER MODE PROXY 어플리케이션

유저모드 어플리케이션 프록시 -> 소켓 스트림

인라인 아웃오브패스 -> 패킷

웹서버 앞에 프록시 서버를 두면 reverse 프록시 , 이러한 reverse proxy는 감시와 보호를 한다 (공격감시 , 서버 보호)  (이것을 web application firewall이라 한다) 

제가 간단한 웹을 만들면서 썼던 nginx가 이런 구조라는 것이군요. 
그렇다면 nginx + 백엔드서버(장고) 같은 구조로 사용한다고 하면, 악성유저의 ddos공격 같은것은 nginx에서 막아야 한다는 말씀인가요?

. L3~4사이 수준 공격이라면 더 앞에 있는 IPS가 대응하는 것이 맞겠습니다. 그리고 중소기업을 위한 DDoS 대응 서비스를 KISA가 제공합니다. 관련해서 한 번 알아보기 바랍니다. 지식의 깊이를 더할 수 있을 겁니다.

웹서버하고 리버스 프록시는 PRIVATE

구조적으로 구글서버는 외부접근불가

리버스 프록시가 공격인지 아닌지 식별.-> 웹방화벽
소켓스트림 감시

L7 HTTP는 소켓통신. STREAM이니까.
